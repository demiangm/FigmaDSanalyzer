<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>PrismaScope - Design System Compliance Analyzer</title>
  <style>
    /* Instruction Button */
    .instruction-button {
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 8px;
      margin-left: auto;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 999px;
      transition: background-color 0.2s;
    }

    .instruction-button:hover {
      background: rgba(0, 0, 0, 0.05);
    }

    /* Content Switcher */
    .content-switcher {
      display: flex;
      gap: 2px;
      background: #f5f5f5;
      padding: 4px;
      border-radius: 12px;
      margin: 16px 0 8px;
    }

    /* Error Message */
    .error {
      background: #fee2e2;
      color: #dc2626;
      padding: 12px;
      border-radius: 6px;
      margin: 0 0 16px;
      font-size: 12px;
      text-align: center;
    }

    .tab-button {
      flex: 1;
      padding: 8px 16px;
      border: none;
      background: transparent;
      font-size: 14px;
      font-weight: 500;
      color: #666;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.2s;
    }

    .tab-button.active {
      background: white;
      color: #333;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .tab-button:hover:not(.active) {
      background: rgba(255,255,255,0.5);
    }

    /* Tab Panels */
    .tab-panel {
      display: none;
    }

    .tab-panel.active {
      display: flex;
      flex-direction: column;
      flex: 1;
    }

    /* Modal/Bottom Sheet */
    .modal {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      padding: 20px;
      border-radius: 12px 12px 0 0;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      transform: translateY(100%);
      transition: transform 0.3s ease-out;
      z-index: 1000;
    }

    .modal h4 {
      margin: 0  ;
    }

    .modal.show {
      transform: translateY(0);
    }

    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease-out;
      z-index: 999;
    }

    .modal-backdrop.show {
      opacity: 1;
      pointer-events: auto;
    }

    /* Empty States */
    .empty-state {
      text-align: center;
      padding: 32px 16px;
      color: #666;
    }

    .empty-state h3 {
      font-size: 16px;
      margin: 0 0 8px;
      color: #333;
    }

    .empty-state p {
      font-size: 14px;
      margin: 0;
      color: #666;
      text-wrap: balance;
    }

    .animated {
      animation: fadeInUp 0.7s cubic-bezier(.23,1.01,.32,1) both;
     }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    /* Issue Cards */
    .issue-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: white;
      border: 1px solid #e5e5e5;
      border-radius: 8px;
      margin: 8px 0;
    }

    .issue-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      min-width: 32px;
      background: #f5f5f5;
      border-radius: 6px;
      color: #666;
    }

    .issue-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .issue-message {
      font-size: 14px;
      font-weight: 500;
      color: #333;
      margin: 0;
    }

    .issue-value {
      font-family: 'SF Mono', 'Consolas', monospace;
      font-size: 13px;
      color: #666;
      margin: 0;
    }

    .issue-action {
      padding: 6px 12px;
      background: transparent;
      border: 1px solid #e5e5e5;
      border-radius: 6px;
      color: #666;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s;
    }

    .issue-action:hover {
      background: #f5f5f5;
      border-color: #d5d5d5;
    }

    .issue-action svg {
      width: 14px;
      height: 14px;
    }

    /* Switch customizado */
    .switch {
      position: relative;
      display: inline-block;
      width: 48px;
      height: 28px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 28px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    .switch input:checked + .slider {
      background-color: #DF0979;
    }
    .switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    .switch .slider {
      box-shadow: 0 0 2px #aaa;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #ffffff;
      color: #333;
    }
    .container {
      padding: 16px;
      height: calc(100vh - 32px);
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }
    .header {
      display: flex;
      align-items: center;
      justify-content:  flex-start;
      padding: 12px 0;
      border-bottom: 1px solid #e5e5e5;
      margin-bottom: 16px;
    }
    .title {
      font-size: 14px;
      font-weight: 600;
      margin: 0;
    }
    /* .nav e .nav button foram removidos, pois as abas n√£o existem mais */
    .hero {
      text-align: center;
      margin: 24px 0;
      text-wrap: balance;
      flex: 1;
    }
    .hero h2 {
      font-size: 18px;
      margin: 0 0 8px;
    }
    .hero p {
      font-size: 14px;
      color: #666;
      margin: 0;
    }
    .button-container {
      display: flex;
      flex-direction: column;
      margin: 16px 0;
      gap: 16px;
    }    
    .analyze-button {
      width: 100%;
      height: 48px;
      background: #DF0979;
      color: white;
      border: none;
      border-radius: 500px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    analyze-button:hover {
      background: #BE0867;
    }
    .error {
      background: #fee2e2;
      color: #dc2626;
      padding: 12px;
      border-radius: 6px;
      margin: 16px 0;
      font-size: 12px;
    }
    .hidden {
      display: none;
    }
    /* As classes .config-section, .input-group e suas subclasses foram removidas */
    .results-card {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 16px;
      margin: 8px 0;
      border: 1px solid #e5e5e5;
    }
    .results-card h3 {
      margin: 0 0 12px;
      font-size: 14px;
      color: #333;
    }
    .metric-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid #e5e5e5;
    }
    .metric-row:last-child {
      border-bottom: none;
    }
    .metric-label {
      font-size: 12px;
      color: #666;
    }
    .metric-value {
      font-size: 12px;
      font-weight: 600;
      padding: 4px 8px;
      border-radius: 4px;
    }
    .metric-excellent { background: #dcfce7; color: #166534; }
    .metric-good { background: #dcfce7; color: #166534; }
    .metric-warning { background: #ffedd5; color: #9a3412; }
    .metric-error { background: #fee2e2; color: #dc2626; }

    .metric-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 8px 0;
      font-size: 12px;
    }
    
    .metric-label {
      color: #666;
    }
    
    .metric-value {
      font-weight: 500;
      padding: 2px 8px;
      border-radius: 4px;
    }
    
    .metric-good {
      background: #dcfce7;
      color: #166534;
    }
    
    .metric-warning {
      background: #fef9c3;
      color: #854d0e;
    }
    
    .metric-error {
      background: #fee2e2;
      color: #dc2626;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <span class="logo-svg" style="display: flex; align-items: center; margin-right: 12px;">
        <svg width="24" height="24" viewBox="0 0 156 156" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M47.05 148.452C41.1393 148.452 35.6776 145.299 32.7221 140.18L3.60844 89.7579C0.652601 84.6386 0.652481 78.3313 3.60815 73.2119L36.6569 15.9698C39.6126 10.8504 45.075 7.6968 50.9863 7.69702L109.21 7.69912C115.121 7.69932 120.582 10.8526 123.538 15.9713L152.652 66.3935C154.129 68.9531 154.868 71.8098 154.868 74.6664L154.868 74.6832C154.868 74.7195 154.868 74.7558 154.868 74.7921C154.847 77.6069 154.108 80.4175 152.652 82.9397L121.01 137.745C121.003 137.756 120.997 137.768 120.99 137.779L119.603 140.182C116.647 145.301 111.185 148.455 105.274 148.454L47.05 148.452ZM74.8381 67.232L23.4376 67.2302L48.9388 23.0609C49.361 22.3296 50.1413 21.879 50.9858 21.8791L101.022 21.8809C101.229 21.8809 101.343 21.9293 101.421 21.9759C101.517 22.0337 101.622 22.1326 101.704 22.2748C101.786 22.4171 101.819 22.5576 101.821 22.6697C101.823 22.7587 101.808 22.8796 101.709 23.054L76.8788 66.0613C76.4551 66.7861 75.6783 67.2321 74.8381 67.232ZM114.869 120.018L140.37 75.8485C140.495 75.6322 140.583 75.4009 140.634 75.1636C140.691 74.8996 140.702 74.6282 140.667 74.3613C140.627 74.0573 140.528 73.7592 140.37 73.4851L115.35 30.1536C115.247 29.9745 115.148 29.8994 115.069 29.8556C114.971 29.8012 114.832 29.7597 114.668 29.7597C114.504 29.7597 114.366 29.8012 114.268 29.8556C114.19 29.8987 114.092 29.9722 113.991 30.1451L113.986 30.1536L89.167 73.1411L89.161 73.1515C88.7447 73.8809 88.7467 74.777 89.167 75.5048L114.869 120.018ZM42.2895 125.971C42.1883 126.143 42.0913 126.216 42.0137 126.259C41.9156 126.314 41.7774 126.355 41.6132 126.355C41.4489 126.355 41.3107 126.314 41.2126 126.259C41.1335 126.215 41.0342 126.14 40.9309 125.961L15.9117 82.6304C15.8083 82.4513 15.7929 82.3278 15.7945 82.2374C15.7964 82.1252 15.8296 81.9847 15.9117 81.8425C15.9938 81.7002 16.0989 81.6013 16.1951 81.5435C16.2726 81.4969 16.3873 81.4485 16.594 81.4485L66.6292 81.4503C66.836 81.4503 66.9506 81.4987 67.0282 81.5453C67.1243 81.6031 67.2294 81.702 67.3115 81.8443C67.3937 81.9865 67.4268 82.127 67.4287 82.2391C67.4303 82.328 67.4155 82.4486 67.3171 82.6224L67.3117 82.6318L67.3115 82.6321L42.2895 125.971ZM79.5991 89.7131C79.7004 89.541 79.7975 89.4678 79.8752 89.4247C79.9733 89.3704 80.1115 89.3288 80.2758 89.3288C80.44 89.3288 80.5782 89.3704 80.6763 89.4247C80.7555 89.4686 80.8547 89.5437 80.9581 89.7227L105.977 133.054C106.081 133.233 106.096 133.356 106.094 133.447C106.093 133.559 106.059 133.699 105.977 133.841C105.895 133.984 105.79 134.083 105.694 134.14C105.616 134.187 105.502 134.235 105.295 134.235L55.2597 134.234C55.053 134.234 54.9383 134.185 54.8608 134.139C54.7646 134.081 54.6595 133.982 54.5774 133.84C54.4953 133.697 54.4622 133.557 54.4602 133.445C54.4586 133.356 54.4734 133.236 54.5715 133.062L54.5773 133.052L54.5774 133.052L79.5934 89.7231L79.5935 89.7228L79.5991 89.7131Z" fill="url(#paint0_linear_5791_20)"/>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M109.21 7.6969C115.121 7.69712 120.582 10.8504 123.538 15.9691L152.652 66.3913C155.607 71.5105 155.608 77.8179 152.652 82.9373L119.603 140.179C116.648 145.299 111.185 148.452 105.274 148.452L47.0501 148.45C41.1394 148.45 35.6777 145.297 32.7222 140.178L3.60857 89.7557C2.13064 87.196 1.39165 84.3394 1.3916 81.4827L1.39161 81.466C1.39165 81.4297 1.3918 81.3934 1.39208 81.357C1.41334 78.5423 2.15208 75.7317 3.60827 73.2095L35.2501 18.4042C35.2537 18.3979 35.2574 18.3916 35.2611 18.3853C35.2641 18.38 35.2672 18.3748 35.2702 18.3695L36.657 15.9676C39.6127 10.8482 45.0751 7.69461 50.9864 7.69482L109.21 7.6969ZM81.422 88.9171L132.822 88.919L107.321 133.088C106.899 133.82 106.119 134.27 105.274 134.27L55.2383 134.268C55.0316 134.268 54.9169 134.22 54.8394 134.173C54.7433 134.116 54.6382 134.017 54.556 133.874C54.4739 133.732 54.4408 133.592 54.4388 133.479C54.4373 133.39 54.4521 133.27 54.5511 133.095L79.375 90.0989L79.3773 90.0948L79.3815 90.0876C79.8052 89.363 80.5819 88.9171 81.422 88.9171ZM41.3913 36.1312L15.8901 80.3006C15.7647 80.5177 15.6766 80.7498 15.6257 80.9879C15.5694 81.2511 15.5586 81.5218 15.5932 81.7879C15.6328 82.0919 15.7318 82.3899 15.8901 82.6641L40.9096 125.996C41.013 126.175 41.1123 126.25 41.1914 126.294C41.2895 126.348 41.4277 126.389 41.592 126.389C41.7562 126.389 41.8944 126.348 41.9925 126.294C42.0704 126.25 42.1678 126.177 42.2694 126.004L42.2743 125.996L67.0931 83.008L67.0993 82.9974C67.5154 82.268 67.5133 81.3721 67.0931 80.6443L41.3913 36.1312ZM113.97 30.1782C114.072 30.0062 114.169 29.933 114.246 29.8899C114.344 29.8356 114.483 29.794 114.647 29.794C114.811 29.794 114.949 29.8356 115.047 29.8899C115.127 29.9338 115.226 30.0089 115.329 30.1879L140.348 73.5188C140.452 73.6979 140.467 73.8213 140.466 73.9118C140.464 74.0239 140.431 74.1644 140.348 74.3067C140.266 74.4489 140.161 74.5479 140.065 74.6056C139.987 74.6522 139.873 74.7006 139.666 74.7006L89.6309 74.6988C89.4241 74.6988 89.3094 74.6504 89.2319 74.6038C89.1358 74.5461 89.0307 74.4471 88.9486 74.3049C88.8664 74.1626 88.8333 74.0222 88.8313 73.91C88.8298 73.8212 88.8446 73.7004 88.9432 73.5265L88.9484 73.5173L88.9486 73.517L113.97 30.1782ZM76.6612 66.4357C76.5598 66.6081 76.4626 66.6813 76.3849 66.7244C76.2868 66.7788 76.1486 66.8203 75.9843 66.8203C75.8201 66.8203 75.6818 66.7788 75.5837 66.7244C75.5046 66.6806 75.4054 66.6055 75.302 66.4264L50.2829 23.0956C50.1795 22.9165 50.164 22.793 50.1656 22.7025C50.1676 22.5904 50.2007 22.4499 50.2828 22.3077C50.365 22.1654 50.4701 22.0665 50.5662 22.0087C50.6438 21.9621 50.7584 21.9137 50.9652 21.9137L101 21.9155C101.207 21.9155 101.322 21.9639 101.399 22.0105C101.495 22.0683 101.601 22.1672 101.683 22.3095C101.765 22.4517 101.798 22.5922 101.8 22.7043C101.801 22.7931 101.787 22.9137 101.688 23.0874L101.683 23.097L101.683 23.0973L76.6667 66.4261L76.6666 66.4264L76.6612 66.4357Z" fill="url(#paint1_linear_5791_20)"/>
          <defs>
            <linearGradient id="paint0_linear_5791_20" x1="37.9006" y1="148.52" x2="119.541" y2="8.10163" gradientUnits="userSpaceOnUse">
              <stop stop-color="#A50AFF"/>
              <stop offset="0.484375" stop-color="#C00AC0" stop-opacity="0.13"/>
            </linearGradient>
            <linearGradient id="paint1_linear_5791_20" x1="37.9007" y1="148.517" x2="119.541" y2="8.09943" gradientUnits="userSpaceOnUse">
              <stop stop-color="#A50AFF"/>
              <stop offset="1" stop-color="#DF0979"/>
            </linearGradient>
          </defs>
        </svg>
      </span>
      <h1 class="title">PrismaScope - Design System Analyzer</h1>
      <button id="button-instruction" class="instruction-button">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10ZM11 14C11 14.5523 10.5523 15 10 15C9.44772 15 9 14.5523 9 14C9 13.4477 9.44772 13 10 13C10.5523 13 11 13.4477 11 14ZM10 5C9.44772 5 9 5.44772 9 6V10C9 10.5523 9.44772 11 10 11C10.5523 11 11 10.5523 11 10V6C11 5.44772 10.5523 5 10 5Z" fill="#666666"/>
        </svg>
      </button>
    </div>

    <div class="content-switcher">
      <button class="tab-button active" data-tab="home">Home</button>
      <button class="tab-button" data-tab="data">Dados</button>
      <button class="tab-button" data-tab="inspect">Inspect</button>
    </div>

    <div id="errorMessage" class="error hidden"></div>

    <!-- Home Panel -->
    <div id="homePanel" class="tab-panel active">
      <div class="hero animated">
        <svg viewBox="0 0 144 144" fill="none" xmlns="http://www.w3.org/2000/svg" width="100" height="100" data-testid="SvgLupaSpotSpot"><path opacity="0" d="M72 132c-9.703-.068-16.027-4.157-19.557-13.233-1.755-4.515-3.163-9.183-4.413-13.869-.634-2.373-1.613-4.343-3.063-5.865-1.522-1.45-3.492-2.429-5.865-3.063-4.686-1.25-9.354-2.658-13.87-4.413C16.158 88.027 12.069 81.703 12 72c.068-9.703 4.157-16.027 13.233-19.557 4.515-1.755 9.183-3.163 13.869-4.413 2.373-.634 4.343-1.613 5.865-3.063 1.45-1.522 2.429-3.492 3.063-5.865 1.25-4.686 2.658-9.354 4.413-13.87C55.973 16.158 62.297 12.069 72 12c9.703.068 16.027 4.157 19.557 13.233 1.755 4.515 3.163 9.183 4.413 13.869.634 2.373 1.613 4.343 3.063 5.865 1.522 1.45 3.492 2.429 5.865 3.063 4.686 1.25 9.354 2.658 13.869 4.413C127.843 55.973 131.932 62.297 132 72c-.068 9.703-4.157 16.027-13.233 19.557-4.515 1.755-9.183 3.163-13.869 4.413-2.373.634-4.343 1.613-5.865 3.063-1.45 1.522-2.429 3.492-3.063 5.865-1.25 4.686-2.658 9.354-4.413 13.869C88.027 127.843 81.703 131.932 72 132" fill="#767676"></path><path opacity="0.24" d="M118.56 110.546a9.195 9.195 0 0 1-13 .003L77.175 82.191l-.21-.21 13.08-12.952.157.156 28.358 28.358a9.194 9.194 0 0 1 0 13.003" fill="#FF0A8C"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M84.305 35.661q8.17 9.576 8.17 22.34 0 8.004-3.212 14.753l27.102 27.018q3.435 3.426 3.435 8.272c0 4.846-1.145 5.988-3.435 8.272q-3.432 3.421-8.264 3.423-4.834.001-8.266-3.419L72.82 89.336Q66.14 92.5 58 92.5q-15.954 0-26.302-12.158Q23.526 70.765 23.526 58q0-12.766 8.171-22.339 10.35-12.16 26.305-12.161 15.953 0 26.301 12.158zm-3.808 3.24q-8.852-10.4-22.496-10.401-13.645 0-22.497 10.402Q28.525 47.078 28.525 58t6.977 19.097Q44.355 87.5 58 87.5t22.497-10.4q6.978-8.177 6.979-19.1 0-10.922-6.977-19.096zm-3.853 10.76a20.4 20.4 0 0 0-2.032-3.396q-2.559-3.446-6.489-5.515-3.757-1.977-7.827-2.23a20 20 0 0 0-3.96.153q-1.025.139-1.85-.487a2.4 2.4 0 0 1-.963-1.653 2.4 2.4 0 0 1 .488-1.85 2.4 2.4 0 0 1 1.653-.964q7.82-1.062 14.788 2.607 7.176 3.777 10.706 11.184a2.5 2.5 0 0 1 .1 1.911 2.5 2.5 0 0 1-.5.838 2.5 2.5 0 0 1-.782.584 2.5 2.5 0 0 1-.945.24 2.5 2.5 0 0 1-.966-.141 2.5 2.5 0 0 1-.838-.5 2.5 2.5 0 0 1-.583-.78ZM44.096 70.614q.749.87 1.547 1.63Q51.156 77.501 59 77.5t13.358-5.255a23 23 0 0 0 1.546-1.631 2.4 2.4 0 0 1 1.709-.862 2.4 2.4 0 0 1 1.817.598q.784.675.862 1.708a2.4 2.4 0 0 1-.598 1.817Q70.272 82.5 59 82.5q-11.273 0-18.695-8.625a2.4 2.4 0 0 1-.598-1.817 2.4 2.4 0 0 1 .862-1.708q.376-.324.85-.48.471-.156.967-.118a2.48 2.48 0 0 1 1.708.862Zm40.209 9.726a36 36 0 0 0 2.375-3.101l26.155 26.075q1.965 1.96 1.965 4.73 0 2.772-1.966 4.732-1.968 1.962-4.735 1.963-2.766 0-4.735-1.961L77.301 86.744q3.774-2.61 7.004-6.404" fill="#151515"></path></svg>
        <h2>Analisar Conformidade do Design System</h2>
        <p>Selecione frames ou componentes e execute uma an√°lise para verificar a conformidade com os padr√µes do nosso design system.</p>
      </div>

      <div class="button-container">
        <button class="analyze-button" id="startAnalysis">Iniciar An√°lise</button>
        <div style="display: flex; align-items: center; justify-content: space-around;">
          <label for="renderCardSwitch" style="font-size: 14px; color: #666; font-weight: 500;">Exportar resultados</label>
          <label class="switch">
            <input type="checkbox" id="renderCardSwitch" checked>
            <span class="slider"></span>
          </label>
        </div>
      </div>

      <p style="font-size: 12px; color: #666; text-align: center;">
        Selecione um ou mais frames no Figma, depois clique em "Iniciar An√°lise" para come√ßar a verifica√ß√£o de conformidade.
      </p>
    </div>

    <!-- Data Panel -->
    <div id="dataPanel" class="tab-panel">
      <div class="empty-state animated" id="dataEmptyState">
          <svg width="56" height="48" viewBox="0 0 56 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="6" y="28" width="8" height="14" rx="2" fill="#e5e7eb">
              <animate attributeName="y" values="28;18;28" dur="1.2s" repeatCount="indefinite"/>
              <animate attributeName="height" values="14;24;14" dur="1.2s" repeatCount="indefinite"/>
            </rect>
            <rect x="20" y="18" width="8" height="24" rx="2" fill="#a5b4fc">
              <animate attributeName="y" values="18;28;18" dur="1.2s" repeatCount="indefinite"/>
              <animate attributeName="height" values="24;14;24" dur="1.2s" repeatCount="indefinite"/>
            </rect>
            <rect x="34" y="24" width="8" height="18" rx="2" fill="#60a5fa">
              <animate attributeName="y" values="24;14;24" dur="1.2s" repeatCount="indefinite"/>
              <animate attributeName="height" values="18;28;18" dur="1.2s" repeatCount="indefinite"/>
            </rect>
            <rect x="48" y="12" width="8" height="30" rx="2" fill="#38bdf8">
              <animate attributeName="y" values="12;22;12" dur="1.2s" repeatCount="indefinite"/>
              <animate attributeName="height" values="30;10;30" dur="1.2s" repeatCount="indefinite"/>
            </rect>
          </svg>
        <h3>Dados n√£o dispon√≠veis</h3>
        <p>Os dados aparecer√£o aqui quando forem gerados na an√°lise.</p>
      </div>
      <div id="resultsContainer" class="hidden"></div>
    </div>

    <!-- Inspect Panel -->
    <div id="inspectPanel" class="tab-panel">
      <div class="empty-state animated" id="inspectEmptyState">
        <svg width="56" height="48" viewBox="0 0 56 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g>
              <rect x="8" y="8" width="40" height="32" rx="4" fill="#e5e7eb"/>
              <rect x="14" y="14" width="28" height="8" rx="2" fill="#a5b4fc">
                <animate attributeName="width" values="28;16;28" dur="1.2s" repeatCount="indefinite"/>
              </rect>
              <rect x="14" y="26" width="18" height="4" rx="2" fill="#60a5fa">
                <animate attributeName="width" values="18;8;18" dur="1.2s" repeatCount="indefinite"/>
              </rect>
              <rect x="34" y="26" width="8" height="4" rx="2" fill="#38bdf8">
                <animate attributeName="width" values="8;16;8" dur="1.2s" repeatCount="indefinite"/>
              </rect>
              <rect x="20" y="34" width="16" height="2" rx="1" fill="#bdbdbd">
                <animate attributeName="width" values="16;8;16" dur="1.2s" repeatCount="indefinite"/>
              </rect>
            </g>
            <g>
              <rect x="44" y="36" width="8" height="8" rx="2" fill="#fbbf24">
                <animate attributeName="y" values="36;32;36" dur="1.2s" repeatCount="indefinite"/>
              </rect>
              <rect x="46" y="38" width="4" height="4" rx="1" fill="#fff"/>
            </g>
          </svg>
        <h3>Nenhuma inspe√ß√£o realizada</h3>
        <p>Os itens inspecionados aparecer√£o aqui ap√≥s a an√°lise.<br>Utilize a aba Home para rodar a an√°lise.</p>
      </div>
      <div id="inspectResults" class="hidden"></div>
    </div>

    <!-- Bottom Sheet Modal -->
    <div class="modal-backdrop" id="modalBackdrop"></div>
    <div class="modal" id="instructionsModal">
      <h4>Sobre o Design System</h4>
      <div id="modalContent">
        <!-- Content will be dynamically populated -->
      </div>
      <button class="analyze-button" onclick="closeModal()" style="margin-top: 16px;">Fechar</button>
    </div>
  </div>

  <script>
    // State
    let currentTab = 'home';
    let designSystem = {
      colors: ['#000000', '#FFFFFF', '#F5F5F5', '#007AFF', '#FF3B30'],
      fonts: ['Inter', 'SF Pro Display', 'Roboto'],
      componentPrefixes: ['DS/', 'Component/', 'UI/']
    };

    // DOM Elements
    const startAnalysisBtn = document.getElementById('startAnalysis');
    const errorMessage = document.getElementById('errorMessage');
    const resultsContainer = document.getElementById('resultsContainer');
    const instructionBtn = document.getElementById('button-instruction');
    const modal = document.getElementById('instructionsModal');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabPanels = document.querySelectorAll('.tab-panel');

    // Event Listeners
    startAnalysisBtn.addEventListener('click', startAnalysis);
    instructionBtn.addEventListener('click', openModal);
    modalBackdrop.addEventListener('click', closeModal);

    tabButtons.forEach(button => {
      button.addEventListener('click', () => switchTab(button.dataset.tab));
    });

    // Functions
    function switchTab(tabName) {
      currentTab = tabName;
      
      // Update buttons
      tabButtons.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.tab === tabName);
      });

      // Update panels
      tabPanels.forEach(panel => {
        if (panel.id === `${tabName}Panel`) {
          panel.classList.add('active');
        } else {
          panel.classList.remove('active');
        }
      });
    }

    function openModal() {
      modal.classList.add('show');
      modalBackdrop.classList.add('show');
    }

    function closeModal() {
      modal.classList.remove('show');
      modalBackdrop.classList.remove('show');
    }

    function startAnalysis() {
      const renderCardSwitch = document.getElementById('renderCardSwitch');
      const renderCard = renderCardSwitch ? renderCardSwitch.checked : true;
      
      parent.postMessage({
        pluginMessage: {
          type: 'analyze-selection',
          renderCard: renderCard
        }
      }, '*');

      startAnalysisBtn.textContent = 'Analisando...';
      startAnalysisBtn.disabled = true;
    }

    function showError(message) {
      errorMessage.textContent = message;
      errorMessage.classList.remove('hidden');
    }

    function hideError() {
      errorMessage.classList.add('hidden');
    }

    function showResults(reports) {
      if (!reports || reports.length === 0) {
        showError('Nenhum resultado encontrado');
        return;
      }

      // Hide empty states
      document.getElementById('dataEmptyState').classList.add('hidden');
      document.getElementById('inspectEmptyState').classList.add('hidden');

      // Show results
      resultsContainer.classList.remove('hidden');
      resultsContainer.innerHTML = reports.map(report => createResultCard(report)).join('');

      // Create inspect view results
      const inspectResults = document.getElementById('inspectResults');
      inspectResults.classList.remove('hidden');
      inspectResults.innerHTML = createInspectView(reports);

      // Switch to data tab
      switchTab('data');
    }

    function createInspectView(reports) {
      const allIssues = reports.flatMap(report => {
        const issues = [];
        const { frameName, nonCompliantItems } = report;

        // Por enquanto vamos usar nonCompliantItems at√© termos os detalhes
        if (nonCompliantItems) {
          if (nonCompliantItems.colors > 0) {
            // Placeholder at√© termos os valores espec√≠ficos
            for (let i = 0; i < nonCompliantItems.colors; i++) {
              issues.push(createIssueCard('color', frameName, '#d9d9d9'));
            }
          }
          if (nonCompliantItems.fonts > 0) {
            for (let i = 0; i < nonCompliantItems.fonts; i++) {
              issues.push(createIssueCard('font', frameName, 'Arial'));
            }
          }
          if (nonCompliantItems.effects > 0) {
            for (let i = 0; i < nonCompliantItems.effects; i++) {
              issues.push(createIssueCard('effect', frameName, 'Drop Shadow'));
            }
          }
          if (nonCompliantItems.components > 0) {
            for (let i = 0; i < nonCompliantItems.components; i++) {
              issues.push(createIssueCard('component', frameName, 'Component'));
            }
          }
        }

        return issues;
      });

      if (allIssues.length === 0) {
        return `
          <div class="empty-state">
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44ZM22 14C22 12.8954 22.8954 12 24 12C25.1046 12 26 12.8954 26 14V26C26 27.1046 25.1046 28 24 28C22.8954 28 22 27.1046 22 26V14ZM24 32C22.8954 32 22 32.8954 22 34C22 35.1046 22.8954 36 24 36C25.1046 36 26 35.1046 26 34C26 32.8954 25.1046 32 24 32Z" fill="currentColor"/>
            </svg>
            <h3>Nenhum problema encontrado</h3>
            <p>Todos os elementos est√£o em conformidade com o Design System.</p>
          </div>
        `;
      }

      return allIssues.join('');
    }

    function createIssueCard(type, frameName, value) {
      const icons = {
        color: '<circle cx="12" cy="12" r="8" fill="currentColor"/>',
        font: '<text x="12" y="16" text-anchor="middle" font-size="14" font-weight="bold" fill="currentColor">T</text>',
        effect: '<path d="M12 16L16 8H8L12 16Z" fill="currentColor"/>',
        component: '<rect x="8" y="8" width="8" height="8" fill="currentColor"/>'
      };

      const messages = {
        color: 'Estilo de "preenchimento" ausente',
        font: 'Fam√≠lia de fonte n√£o conforme',
        effect: 'Efeito n√£o conforme',
        component: 'Componente n√£o conforme'
      };

      return `
        <div class="issue-card">
          <div class="issue-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              ${icons[type]}
            </svg>
          </div>
          <div class="issue-content">
            <p class="issue-message">${messages[type]}</p>
            <p class="issue-value">${value}</p>
          </div>
          <button class="issue-action" onclick="focusIssue('${frameName}', '${value}')">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2ZM0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8ZM8 6C7.44772 6 7 6.44772 7 7V11C7 11.5523 7.44772 12 8 12C8.55228 12 9 11.5523 9 11V7C9 6.44772 8.55228 6 8 6ZM8 3C7.44772 3 7 3.44772 7 4C7 4.55228 7.44772 5 8 5C8.55228 5 9 4.55228 9 4C9 3.44772 8.55228 3 8 3Z" fill="currentColor"/>
            </svg>
          </button>
        </div>
      `;
    }

    function updateDataSummary(summary) {
      const dataSummary = document.getElementById('dataSummary');
      const summaryContent = document.getElementById('summaryContent');
      const modalContent = document.getElementById('modalContent');

      const summaryHtml = `
        <div>‚Ä¢ ${summary.components} componentes</div>
        <div>‚Ä¢ ${summary.colorStyles} estilos de cor</div>
        <div>‚Ä¢ ${summary.textStyles} estilos de texto</div>
        <div>‚Ä¢ ${summary.effectStyles} estilos de efeito</div>
      `;

      summaryContent.innerHTML = summaryHtml;
      modalContent.innerHTML = `
        <p>Dados carregados do Prisma para an√°lise:</p>
        ${summaryHtml}
      `;

      dataSummary.classList.remove('hidden');
    }

    function createResultCard(report) {
      const getMetricClass = (value) => {
        if (value >= 90) return 'metric-excellent';
        if (value >= 70) return 'metric-good';
        return 'metric-error';
      };

      const getCoverageClass = (level) => {
        if (!level) return 'metric-error';
        switch (level.label || level) {
          case '√ìtima': return 'metric-excellent';
          case 'Boa': return 'metric-good';
          case 'Baixa': return 'metric-warning';
          case 'Muito baixa': return 'metric-error';
          default: return 'metric-error';
        }
      };

      return `
        <div class="results-card">
          <h3>${report.frameName}</h3>
          
          <div class="metric-row">
            <span class="metric-label">Cobertura do Design System</span>
            <span class="metric-value ${getCoverageClass(report.coverageLevel)}">
              ${report.coverageLevel.emoji ? report.coverageLevel.emoji + ' ' : ''}${report.coverageLevel.label || report.coverageLevel} (${report.coveragePercentage}%)
            </span>
          </div>

          <div class="metric-row">
            <span class="metric-label">Total de Camadas</span>
            <span class="metric-value">${report.totalLayers}</span>
          </div>

          <div class="metric-row">
            <span class="metric-label">Elementos do DS</span>
            <span class="metric-value">${report.dsComponentsUsed}</span>
          </div>

          <h4 style="margin: 16px 0 8px; font-size: 12px;">Itens fora do Design System:</h4>
          
          <div class="metric-row">
            <span class="metric-label">Componentes</span>
            <span class="metric-value ${report.nonCompliantItems.components > 0 ? 'metric-error' : 'metric-good'}">
              ${report.nonCompliantItems.components}
            </span>
          </div>

          <div class="metric-row">
            <span class="metric-label">Cores</span>
            <span class="metric-value ${report.nonCompliantItems.colors > 0 ? 'metric-error' : 'metric-good'}">
              ${report.nonCompliantItems.colors}
            </span>
          </div>

          <div class="metric-row">
            <span class="metric-label">Fontes</span>
            <span class="metric-value ${report.nonCompliantItems.fonts > 0 ? 'metric-error' : 'metric-good'}">
              ${report.nonCompliantItems.fonts}
            </span>
          </div>

          <div class="metric-row">
            <span class="metric-label">Efeitos</span>
            <span class="metric-value ${report.nonCompliantItems.effects > 0 ? 'metric-error' : 'metric-good'}">
              ${report.nonCompliantItems.effects}
            </span>
          </div>
        </div>
      `;
    }

    function focusIssue(frameName, value) {
      parent.postMessage({
        pluginMessage: {
          type: 'focus-issue',
          frameName: frameName,
          value: value
        }
      }, '*');
    }

    // Initialize
    parent.postMessage({ pluginMessage: { type: 'get-design-system' } }, '*');

    // Plugin message handler
    window.addEventListener('message', (event) => {
      const message = event.data.pluginMessage;

      switch (message.type) {
        case 'analysis-complete':
          startAnalysisBtn.textContent = 'Iniciar An√°lise';
          startAnalysisBtn.disabled = false;
          hideError();
          showResults(message.reports);
          break;

        case 'analysis-error':
          startAnalysisBtn.textContent = 'Iniciar An√°lise';
          startAnalysisBtn.disabled = false;
          showError(message.message);
          break;

        case 'design-system-loaded':
          if (message.summary) {
            updateDataSummary(message.summary);
          }
          break;
      }
    });
  </script>

  <!-- Bottom Sheet Modal -->
  <div class="modal-backdrop" id="modalBackdrop"></div>
  <div class="modal" id="instructionsModal">
    <h3>Sobre o Design System</h3>
    <div id="dataSummary" style="background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 6px; padding: 12px; margin: 16px 0;">
      <h4 style="margin: 0 0 8px; font-size: 12px; color: #0369a1;">Design System Carregado:</h4>
      <div id="summaryContent" style="font-size: 11px; color: #0369a1;"></div>
    </div>
    <button class="analyze-button" onclick="closeModal()" style="margin-top: 16px;">Fechar</button>
  </div>
</body>
</html>